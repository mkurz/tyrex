<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE document SYSTEM "document.dtd">
<document url="http://tyrex.exolab.org/recovery.xml">
  <properties>
    <author email="jdaniel@intalio.com">Jerome DANIEL</author>
  </properties>
  <body>

    <section title="Introduction">
        <p>
        This document quickly explains how is working the recovery mechanism in Tyrex. In
        addition, it provides useful examples to configure and activate recovery.
        </p>
    </section>
    
    <section title="How is working the recovery in Tyrex ?">
    	<p>
    	Each transaction event ( like 'begin transaction', 'prepare transaction', and so on... ) are 
    	stored into a log file. There is a log file per day. The log file is automatically changed
    	at 12 AM. 
    	</p>
    	<p>
    	When you start Tyrex ( and if the log system is activated ) the first log file is created. A log
    	file must not be delete !. However, if you stop Tyrex and if there is no pending transaction ( in this
 	case, there will no need for recovery ), you can remove the log files.
    	</p>
    	<p>
    	If an error occurs in Tyrex, and if it shutdowns ( don't delete the log files ), restart it by activating
    	the recovery. The recovery engine will read all log files to find uncompleted transactions and to rollback
    	or to commit them.
    	</p>
    	<p>
    	Thus, in Tyrex, the recovery is divided into two parts :
    	<li>a log mechanism,</li>
    	<li>and a recovery mechanism ( which used the logs ).</li>
    	</p>
    </section>
        
    <section title="How to configure Tyrex to use the log ?">
        <p>
        To use the log, you have to provide a directory path in order to create the log files. To do that,
        use the <b>Configure</b> object and the 'setLogProperty' operation. This operation takes as parameter a string
        that gives the directory name ( this directory must be previously created ).        
        </p>                      
    </section>

    <section title="How to activate the recovery ?">
        <p>
        To activate the recovery, you have to use the <b>Configure</b> object and more precisely the 'activateRecovery()' method.
        </p>
    </section>
            
    <section title="Problems">
        <p>If you encounter problems with the recovery mechanism send a detailed email to 
        <a href="mailto:tyrex-dev@exolab.org">Tyrex Developer's Mailing List</a>.
        </p>
        <p>
        The email should contain:
        <ul>
        <li>A stacktrace if one is available</li>
        <li>The database used, including version number, if one is used</li>
        <li>The JDBC driver version number</li>
        <li>Instructions on how to reproduce the problem</li>        
        </ul>
        </p>
    </section>

  </body>
</document>